initialize() {
//heliconius u
initializeMutationRate(2.9e-9);
initializeMutationType("m1", 0.5, "f", 0.0);
initializeMutationType("m2", 1.0, "f", 0.3); // introduced mutation
initializeGenomicElementType("g1", m1, 1.0);
initializeGenomicElement(g1, 0, 300000);
/// recombination rate comes from analysis of heredity 2012 data compared to physical size
initializeRecombinationRate(4.4397e-8);
}
1 early() {
// save this run's identifier, used to save and restore
defineConstant("simID", getSeed());
sim.addSubpop("p1", 10000);
sim.addSubpop("p2", 10000);
p1.setMigrationRates(p2, 0.5); //  migration p2 -> p1
p2.setMigrationRates(p1, 0.5); //  migration p1 -> p2

}

1:1000 mutationEffect(m2) { return 0.9; }

1000:1160 mutationEffect(m2,p1) {
if (homozygous)
return 1.3;
else
return 1.3;
}

1000:1160 mutationEffect(m2,p2) { return 0.9; }


1:1000 early() { 
target = sample(p1.genomes, 1);
target.addNewDrawnMutation(m2, 150000);
}



1160:20000 mutationEffect(m2) { return 0.9; }


///1820 peak of the industrial revolution
///1970 clean air legislation (let's say 1980 for environmental effect)
///160 generations


1000:20000 late() {
if (sim.countOfMutationsOfType(m2) == 0)
{
fixed = (sum(sim.substitutions.mutationType == m2) == 1);
cat(simID + ifelse(fixed, ": FIXED\n", ": LOST\n"));
sim.simulationFinished();
}
}
